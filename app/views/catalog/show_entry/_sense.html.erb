<%# We pass in
        * the sense,
        * its index in the senses array (zero-based),
        * and the document presenter (for access to the #*_html methods).


      A sense has
        * a sense-number
        * a definition
        * zero or more EGs (citations/quotations)
        * a javascript mechanism for hiding/expanding the egs
%>

<%
  num_citations = sense.egs.flat_map(&:quotes).size
  uid = [sense.sense_number.to_s, index, 'toggle'].join('-')
%>

<div class="sense">
  <div class="entry-senses">
    <div class="sense-number"><%= sense.sense_number %>.</div>
      <div class="definition"><%== presenter.def_html(sense) %>

      <div class="quote-toggles">
        <a class="quote-toggle <%= uid %>" href="#" onClick="$('.<%= uid%>').toggle(); return false">Show&nbsp;<%= num_citations %>&nbsp;<%= "Quote".pluralize(num_citations) %></a>
        <a class="quote-toggle  <%= uid %> collapsed" href="#" onClick="$('.<%= uid%>').toggle(); return false">Hide&nbsp;<%= num_citations %>&nbsp;<%= "Quote".pluralize(num_citations) %></a>
      </div>
    </div>
  </div>

  <div class="egs">
    <% sense.egs.each do |eg| %>
      <div class="eg collapsed <%= uid %>">
        <% if eg.subdef_entry and eg.subdef_entry =~ /\S/ %>
          <div class="subdef-entry-number"><%= eg.subdef_entry %></div>
        <% end %>
        <div class="citations">
          <ul>
            <% eg.citations.each do |cite| %>
              <li><%== presenter.citation_html(cite) %></li>
            <% end %>
          </ul>
        </div>

      </div>
    <% end %>
  </div>

</div>
